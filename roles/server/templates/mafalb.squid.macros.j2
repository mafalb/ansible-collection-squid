{#
# This file is part of ansible-collection-squid
# Copyright (c) 2021 Markus Falb <markus.falb@mafalb.at>
#
# ansible-collection-squid is free software: you can redistribute it   
# and/or modify it under the terms of the GNU General Public License as
# published by the Free Software Foundation, either version 3 of the
# License, or (at your option) any later version.
#
# ansible-collection-squid is distributed in the hope that it will be
# useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with ansible-collection-squid.
# If not, see <https://www.gnu.org/licenses/>.
-#}

{% macro acl(acl) %}
{% for ace in acl.value.ACEs %}
acl {{ acl.key }} {{ acl.value.acltype }} {{ ace.value }}{% if ace.comment is defined %} {{ '#'|indent(22-(ace.value|string|length),true) }} {{ ace.comment }}{% endif %}

{% endfor %}
{% endmacro -%}

{% macro http_access_directive(rule) %}
http_access {{ rule.action }} {{ rule.aclname }}{% if rule.comment is defined %} {{ '#'|indent(22-(rule.aclname|string|length),true) }} {{ rule.comment }}{% endif %}
{% endmacro -%}

{% macro option(option) %}
{% if option.comment is defined %}# {{ option.comment }}{% endif %}

{{ option.name }} {{ option.value }}
{% endmacro -%}

{% macro refresh_pattern_directive(pattern) %}
refresh_pattern {% if pattern.case_insensitive|default(false)|bool -%}-i {% endif %}{{ pattern.regex }} {{ pattern.min }} {{ pattern.percent }}% {{ pattern.max -}}
{% endmacro -%}

